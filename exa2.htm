<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<script src="exa.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœŸæœ«è€ƒç·šä¸Šæ¸¬é©—ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0f9ff; /* é¦¬å¡é¾è—è‰²èƒŒæ™¯ */
        }
        .macaron-pink { background-color: #fce7f3; color: #831843; }
        .macaron-blue { background-color: #e0f2fe; color: #075985; }
        .macaron-green { background-color: #f0fdf4; color: #14532d; }
        .macaron-yellow { background-color: #fefce8; color: #713f12; }
        .macaron-purple { background-color: #f5f3ff; color: #4c1d95; }
            
        .btn {
            transition: all 0.2s ease-in-out;
            border-radius: 0.75rem;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            font-size: 1.125rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
        .option-btn.selected {
            background-color: #60a5fa; /* æ·±ä¸€é»çš„è—è‰²è¡¨ç¤ºå·²é¸æ“‡ */
            color: white;
            border: 2px solid #2563eb;
        }
        .correct {
            background-color: #dcfce7 !important;
            border-color: #22c55e !important;
            color: #15803d !important;
        }
        .incorrect {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
            color: #b91c1c !important;
        }
        .app-container {
            max-width: 800px;
            margin: 2rem auto;
            background-color: white;
            border-radius: 1.5rem;
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            padding: 2.5rem;
            border: 1px solid #e5e7eb;
        }
        input[type="text"] {
            font-size: 1.125rem;
            padding: 0.75rem;
            border-radius: 0.75rem;
        }
    </style>
</head>
<body class="antialiased text-slate-800">

    <div id="app-container" class="app-container">

        <div id="start-screen">
            <div class="text-center">
                <h1 class="text-5xl font-bold text-blue-600 mb-2">ğŸš€ æœŸæœ«è€ƒ ğŸš€</h1>
                <p class="text-xl text-slate-500 mb-8">ç­‰å€™è€å¸«æŒ‡ä»¤ï¼Œæº–å‚™é€²å…¥æœŸæœ«è€ƒè©¦</p>
            </div>
            <div class="space-y-6">
                <div>
                    <label for="studentId" class="text-lg font-medium text-slate-700">Gmail</label>
                    <input type="text" id="studentId" readonly style="background-color: #f0f0f0;" class="mt-1 block w-full border border-slate-300 focus:ring-blue-500 focus:border-blue-500" placeholder="è«‹è¼¸å…¥æ‚¨çš„ç­ç´šåº§è™Ÿï¼ˆ4ç¢¼ï¼‰">



                </div>
                <div>
                    <label for="studentName" class="text-lg font-medium text-slate-700">ç­ç´šåº§è™Ÿ</label>
                    <input type="text" id="studentName" readonly style="background-color: #f0f0f0;" class="mt-1 block w-full border border-slate-300 focus:ring-blue-500 focus:border-blue-500" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å">
                </div><font color="#F00">å¾…è€å¸«å£ä»¤ï¼Œæ‰èƒ½æŒ‰ã€Œé–‹å§‹æ¸¬é©—ã€<br>è€ƒè©¦æ™‚é–“20åˆ†é˜ï¼Œè¦ã€Œç¹³äº¤è©¦å·ã€è©•åˆ†è«‹èˆ‰æ‰‹ï¼Œå¾…è€å¸«åˆ°åº§ä½æ—ï¼Œå†æŒ‰ã€Œç¹³äº¤è©¦å·ã€</font>
	<div id="sayy">æª¢æŸ¥ä¸­â€¦â€¦</div>
                <button style="display: none;" id="start-btn" class="w-full btn bg-blue-500 text-white hover:bg-blue-600">é–‹å§‹æ¸¬é©—</button>
            </div>
        </div>

        <div id="quiz-screen" class="hidden">
            <div class="flex justify-between items-center mb-6 pb-4 border-b">
                <div class="flex items-baseline gap-3">
                    <span id="quiz-student-info" class="text-2xl font-semibold text-slate-600"></span>
                    <h2 class="text-3xl font-bold text-blue-600">æ¸¬é©—é€²è¡Œä¸­...</h2>
                </div>
                <div id="timer" class="text-2xl font-semibold macaron-pink px-4 py-2 rounded-lg">â±ï¸ 00:00</div>
            </div>
                
            <div class="mb-6">
                <p id="question-counter" class="text-lg font-medium text-slate-500 text-right"></p>
                <p id="question-text" class="text-2xl font-semibold my-4 min-h-[100px]"></p>
            </div>

            <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                </div>

            <div id="navigation-container" class="flex justify-between mt-10">
                <button id="prev-btn" class="btn bg-slate-200 text-slate-700 hover:bg-slate-300">ä¸Šä¸€é¡Œ</button>
                <button id="next-btn" class="btn bg-blue-500 text-white hover:bg-blue-600">ä¸‹ä¸€é¡Œ</button>
                <span id="submit-btn2" class="hidden btn bg-red-500 text-white hover:bg-red-600">==è«‹èˆ‰æ‰‹ç­‰å¾…è€å¸«ä¾†åˆ°ï¼Œæ‰èƒ½æŒ‰ã€Œç¹³äº¤è©¦å·ã€==</span>
                <button id="submit-btn" class="hidden btn bg-green-500 text-white hover:bg-green-600">ç¹³äº¤è©¦å·</button>

            </div>
        </div>

        <div id="results-screen" class="hidden">
            <div class="text-center">
                <h2 class="text-4xl font-bold text-blue-600 mb-4">æ¸¬é©—çµæœ</h2>
                <p class="text-lg text-slate-600 mb-2">Gmailï¼š<span id="result-student-id" class="font-semibold"></span></p>
                <p class="text-lg text-slate-600 mb-6">ç­ç´šåº§è™Ÿï¼š<span id="result-student-name" class="font-semibold"></span></p>

                <div class="flex justify-center items-center gap-8 my-8">
                    <div class="macaron-green p-6 rounded-2xl text-center">
                        <p class="text-xl">ç¸½åˆ†</p>
                        <p id="score" class="text-6xl font-bold"></p>
                    </div>
                    <div class="macaron-blue p-6 rounded-2xl text-center">
                        <p class="text-xl">æ¸¬é©—æ™‚é–“</p>
                        <p id="time-taken" class="text-3xl font-bold"></p>
                    </div>
                </div>
            </div>

            <div>
                <h3 class="text-2xl font-bold text-slate-700 mb-4 border-b pb-2">é¡Œç›®è©³è§£</h3>
                <div id="detailed-results" class="space-y-6">
                    </div>
            </div>
        </div>
    </div>


<script>

    const storedGM = localStorage.getItem('Global_GM');
    const storedSEAT = localStorage.getItem('Global_SEAT');

    document.addEventListener('DOMContentLoaded', () => {
        const studentIdInput = document.getElementById('studentId');
        const studentNameInput = document.getElementById('studentName');
            
        if (studentIdInput) {
            studentIdInput.value = storedGM || '';
            studentNameInput.value = storedSEAT || '';
        }
    });

</script>


<script>
 

    // --- DOM å…ƒç´  ---
    const startScreen = document.getElementById('start-screen');
    const quizScreen = document.getElementById('quiz-screen');
    const resultsScreen = document.getElementById('results-screen');

    const studentIdInput = document.getElementById('studentId'); // GMAIL
    const studentNameInput = document.getElementById('studentName'); // ç­ç´šåº§è™Ÿ
    const startBtn = document.getElementById('start-btn');

    const quizStudentInfoEl = document.getElementById('quiz-student-info');
    const timerEl = document.getElementById('timer');
    const questionCounterEl = document.getElementById('question-counter');
    const questionTextEl = document.getElementById('question-text');
    const optionsContainer = document.getElementById('options-container');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const submitBtn = document.getElementById('submit-btn');
    const restartBtn = document.getElementById('restart-btn');
    const submitBtn2 = document.getElementById('submit-btn2');


    const downloadPdfBtn = document.getElementById('download-pdf-btn');
    const downloadCsvBtn = document.getElementById('download-csv-btn');

    // --- æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹ ---
    let quizQuestions = [];
    let currentQuestionIndex = 0;
    let userAnswers = [];
    let timerInterval;
    let secondsElapsed = 0;
    const totalQuizQuestions = 20;

    // --- å‡½å¼ ---

    // æ´—ç‰Œæ¼”ç®—æ³• (Fisher-Yates)
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function showModal(message) {
        alert(message);
    }

    function startQuiz() {
        const studentId = studentIdInput.value.trim();
        const studentName = studentNameInput.value.trim();

        if (!studentId || !studentName) {
            showModal('è«‹è¼¸å…¥ Gmail å’Œç­ç´šåº§è™Ÿï¼');
            return;
        }

        quizStudentInfoEl.textContent = `${studentId} ${studentName}`;

        // åˆå§‹åŒ–/é‡è¨­ç‹€æ…‹
        secondsElapsed = 0;
        currentQuestionIndex = 0;

        // éš¨æ©ŸæŠ½é¡Œä¸¦æ´—ç‰Œé¸é …
        quizQuestions = shuffleArray([...questionBank]).slice(0, totalQuizQuestions);
        quizQuestions.forEach(q => shuffleArray(q.options));
        
        userAnswers = new Array(quizQuestions.length).fill(null);

        startScreen.classList.add('hidden');
        resultsScreen.classList.add('hidden');
        quizScreen.classList.remove('hidden');

        startTimer();
        renderQuestion();
    }

    function renderQuestion() {
        const question = quizQuestions[currentQuestionIndex];
        questionCounterEl.textContent = `ç¬¬ ${currentQuestionIndex + 1} / ${quizQuestions.length} é¡Œ`;
        questionTextEl.textContent = question.question;

        optionsContainer.innerHTML = '';
        question.options.forEach(option => {
            const button = document.createElement('button');
            button.textContent = option;
            button.classList.add('btn', 'option-btn', 'macaron-purple', 'w-full', 'text-left');
            if (userAnswers[currentQuestionIndex] === option) {
                button.classList.add('selected');
            }
            button.onclick = () => selectAnswer(option);
            optionsContainer.appendChild(button);
        });
        
        updateNavigation();
    }
    
    function selectAnswer(option) {
        userAnswers[currentQuestionIndex] = option;
        // æ›´æ–°é¸é …æŒ‰éˆ•æ¨£å¼
        const buttons = optionsContainer.querySelectorAll('.option-btn');
        buttons.forEach(btn => {
            if (btn.textContent === option) {
                btn.classList.add('selected');
            } else {
                btn.classList.remove('selected');
            }
        });

        // è‡ªå‹•è·³åˆ°ä¸‹ä¸€é¡Œï¼Œå¦‚æœæ˜¯æœ€å¾Œä¸€é¡Œå‰‡åœä½
        setTimeout(() => {
            if (currentQuestionIndex < quizQuestions.length - 1) {
                currentQuestionIndex++;
                renderQuestion();
            } else {
                updateNavigation();
            }
        }, 200);
    }

    function updateNavigation() {
        prevBtn.classList.toggle('hidden', currentQuestionIndex === 0);
        nextBtn.classList.toggle('hidden', currentQuestionIndex === quizQuestions.length - 1);
        submitBtn.classList.toggle('hidden', currentQuestionIndex !== quizQuestions.length - 1);
        submitBtn2.classList.toggle('hidden', currentQuestionIndex !== quizQuestions.length - 1);
    }

    function prevQuestion() {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            renderQuestion();
        }
    }

    function nextQuestion() {
        if (currentQuestionIndex < quizQuestions.length - 1) {
            currentQuestionIndex++;
            renderQuestion();
        }
    }
    
    async function submitQuiz() {
        const unanswered = userAnswers.filter(a => a === null).length;
        const confirmationMessage = unanswered > 0
            ? `æ‚¨é‚„æœ‰ ${unanswered} é¡Œæœªä½œç­”ï¼Œç¢ºå®šè¦ç¹³äº¤å—ï¼Ÿ`
            : `ç¢ºå®šè¦ç¹³äº¤è©¦å·å—ï¼Ÿ`;
        
        if (!confirm(confirmationMessage)) {
            return;
        }

        clearInterval(timerInterval);
        
        // --- è¨ˆç®—åˆ†æ•¸ ---
        let score = 0;
        quizQuestions.forEach((q, index) => {
            if(q.answer === userAnswers[index]) {
                score += 100 / quizQuestions.length;
            }
        });
        const finalScore = Math.round(score);

        // --- å‘¼å« Apps Script å„²å­˜æˆç¸¾ ---
        // !!! è«‹å°‡é€™è£¡æ›¿æ›æˆæ‚¨éƒ¨ç½² toscore.gs å¾Œå–å¾—çš„å¯¦éš›åŸ·è¡Œ URL !!!
        const scriptUrl = 'https://script.google.com/macros/s/AKfycbwIgufZWQ1XPEJ1eQ_eQwAEJnIjxdjZoB_hIuNCoNgf6AXDHRG06CBGuTf_7vJQi2Xq4Q/exec'; 

        const resultData = {
            action: 'saveScore',
            date: new Date().toLocaleString('zh-TW', { timeZone: 'Asia/Taipei' }),
            gmail: studentIdInput.value.trim(),
            score: finalScore,
            seat: studentNameInput.value.trim()
        };

        try {
            const response = await fetch(scriptUrl, {
                method: 'POST',
                mode: 'no-cors', 
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(resultData)
            });

            console.log('æˆç¸¾ç™¼é€è‡³ Apps Script å®Œæˆã€‚');
            showModal('æˆç¸¾å·²æˆåŠŸé€å‡ºï¼');
            window.close();

        } catch (error) {
            console.error('ç™¼é€æˆç¸¾è‡³ Apps Script å¤±æ•—:', error);
            showModal('âš  æˆç¸¾é€å‡ºå¤±æ•—ï¼Œè«‹ç«‹å³å‘ŠçŸ¥è€å¸«ï¼');
        }
        // --- å„²å­˜æˆç¸¾çµæŸ ---

        quizScreen.classList.add('hidden');
        resultsScreen.classList.remove('hidden');
        renderResults(finalScore);
    }
    
    function renderResults(finalScore) {
        document.getElementById('score').textContent = finalScore;
        document.getElementById('result-student-id').textContent = studentIdInput.value;
        document.getElementById('result-student-name').textContent = studentNameInput.value;
        document.getElementById('time-taken').textContent = formatTime(secondsElapsed);
        
        const detailedResultsContainer = document.getElementById('detailed-results');
        detailedResultsContainer.innerHTML = '';

        quizQuestions.forEach((q, index) => {
            const resultDiv = document.createElement('div');
            resultDiv.classList.add('p-4', 'rounded-lg', 'border');
            
            const userAnswer = userAnswers[index];
            const isCorrect = userAnswer === q.answer;
            
            resultDiv.innerHTML = `
                <p class="font-bold text-lg mb-2">${index + 1}. ${q.question}</p>
                <p class="pl-4 mb-1 ${isCorrect ? 'text-green-600' : 'text-red-600'}">
                    ä½ çš„ç­”æ¡ˆï¼š${userAnswer || 'æœªä½œç­”'} 
                    ${isCorrect ? 'âœ”ï¸' : 'âŒ'}
                </p>
                ${!isCorrect ? `<p class="pl-4 mb-2 text-blue-700">æ­£ç¢ºç­”æ¡ˆï¼š${q.answer}</p>` : ''}
                <div class="mt-2 p-3 macaron-yellow rounded-md">
                    <p class="font-semibold">è©³è§£ï¼š</p>
                    <p>${q.explanation}</p>
                </div>
            `;
            
            resultDiv.classList.add(isCorrect ? 'bg-green-50' : 'bg-red-50');
            detailedResultsContainer.appendChild(resultDiv);
        });
    }
    
    function startTimer() {
        clearInterval(timerInterval); // å…ˆæ¸…é™¤æ—¢æœ‰çš„è¨ˆæ™‚å™¨
        timerInterval = setInterval(() => {
            secondsElapsed++;
            timerEl.textContent = `â±ï¸ ${formatTime(secondsElapsed)}`;
        }, 1000);
    }

    function formatTime(seconds) {
        const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
        const secs = (seconds % 60).toString().padStart(2, '0');
        return `${mins}:${secs}`;
    }
    
    function restartQuiz() {
        clearInterval(timerInterval);
        resultsScreen.classList.add('hidden');
        quizScreen.classList.add('hidden');
        startScreen.classList.remove('hidden');
    }
    
    // --- ä¸‹è¼‰åŠŸèƒ½ (ä¿æŒä¸è®Š) ---
    const { jsPDF } = window.jspdf;

    function downloadPDF() {
        const doc = new jsPDF();
        
        doc.setFontSize(22);
        doc.text("Quiz Result", 105, 20, null, null, "center");

        doc.setFontSize(12);
        doc.text(`Gmail: ${studentIdInput.value}`, 20, 40);
        doc.text(`ç­ç´šåº§è™Ÿ: ${studentNameInput.value}`, 20, 50);
        doc.text(`Score: ${document.getElementById('score').textContent}`, 120, 40);
        doc.text(`Time Taken: ${formatTime(secondsElapsed)}`, 120, 50);

        const tableColumn = ["#", "Question", "Your Answer", "Correct Answer", "Result"];
        const tableRows = [];

        quizQuestions.forEach((q, index) => {
            const isCorrect = userAnswers[index] === q.answer;
            const row = [
                index + 1,
                q.question, 
                userAnswers[index] || "N/A",
                q.answer,
                isCorrect ? "Correct" : "Incorrect"
            ];
            tableRows.push(row);
        });

        doc.autoTable({
            head: [tableColumn],
            body: tableRows,
            startY: 60,
        });
        
        doc.save(`quiz-result-${studentIdInput.value}.pdf`);
    }

    function downloadCSV() {
        let csvContent = "data:text/csv;charset=utf-8,\ufeff"; // BOM for UTF-8
        csvContent += "æ—¥æœŸ,GMAIL,ç¸½åˆ†,ç­ç´šåº§è™Ÿ,æ¸¬é©—æ™‚é–“\n";
        csvContent += `${new Date().toLocaleDateString()},${studentIdInput.value},${document.getElementById('score').textContent},${studentNameInput.value},${formatTime(secondsElapsed)}\n\n`;

        csvContent += "é¡Œè™Ÿ,é¡Œç›®,ä½ çš„ç­”æ¡ˆ,æ­£ç¢ºç­”æ¡ˆ,çµæœ\n";
        quizQuestions.forEach((q, index) => {
            const isCorrect = userAnswers[index] === q.answer;
            const row = [
                index + 1,
                `"${q.question.replace(/"/g, '""')}"`, // è™•ç†å¼•è™Ÿ
                userAnswers[index] || "æœªä½œç­”",
                q.answer,
                isCorrect ? "ç­”å°" : "ç­”éŒ¯"
            ].join(',');
            csvContent += row + "\r\n";
        });

        const encodedUri = encodeURI(csvContent);
        const link = document.createElement("a");
        link.setAttribute("href", encodedUri);
        link.setAttribute("download", `quiz-result-${studentIdInput.value}.csv`);
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

//~~~~~~~~~~~~

 // æ‚¨æä¾›çš„ Google Apps Script URL
    const GAS_URL = "https://script.google.com/macros/s/AKfycbzzPfTPtIs7k7q8tVMwpiWQpRMbV_-5rxo82YHkTGExdQoevZy7GEF9tsQmy8OvXGhOgw/exec"; 
    
    // ç²å– HTML å…ƒç´  (é€™äº›å…ƒç´ å¿…é ˆåœ¨ HTML é é¢ä¸­å­˜åœ¨)
    const form = document.getElementById('queryForm');
    const gmailInput = document.getElementById('gmailInput');
    const resultDiv = document.getElementById('result');
    const submitButton = document.getElementById('submitButton');

    // é è¨­æŸ¥è©¢çš„ GMAIL å¸³è™Ÿ
    const DEFAULT_GMAIL = storedGM;

    /**
     * è‡ªå‹•åŸ·è¡Œ GMAIL åˆ†æ•¸æŸ¥è©¢çš„å‡½å¼
     */
    function autoQuery() {
        // è¨­å®šè¼¸å…¥æ¡†å€¼å’Œç‹€æ…‹
        if (gmailInput) {
            gmailInput.value = DEFAULT_GMAIL;
        }
        if (resultDiv) {
            resultDiv.className = '';
            resultDiv.innerHTML = 'ç¶²é å·²è‡ªå‹•åŸ·è¡ŒæŸ¥è©¢ä¸­ï¼Œè«‹ç¨å€™...';
        }
        if (submitButton) {
            submitButton.disabled = true;
        }
        
        const gmail = DEFAULT_GMAIL; // ç›´æ¥ä½¿ç”¨é è¨­å€¼
        
        // ä½¿ç”¨ FormData å»ºç«‹è¦å‚³é€çš„è³‡æ–™
        const formData = new FormData();
        formData.append('gmail', gmail); 

        // ------------------------------------
        // Fetch æŸ¥è©¢é‚è¼¯
        // ------------------------------------
        fetch(GAS_URL, {
            method: 'POST',
            body: formData 
        })
        .then(response => {
            if (!response.ok) {
                // å¦‚æœæ˜¯ HTTP éŒ¯èª¤ï¼Œæ‹‹å‡ºéŒ¯èª¤è¨Šæ¯
                throw new Error(`ä¼ºæœå™¨éŒ¯èª¤ (HTTP ${response.status})`);
            }
            return response.json(); 
        })
        .then(data => {
            // æŸ¥è©¢å®Œæˆï¼Œæ¢å¾©æŒ‰éˆ•ç‹€æ…‹
            if (submitButton) submitButton.disabled = false;

            if (data && data.score !== undefined) {
                const score = data.score;
                
                if (score.toString().includes('æŸ¥ç„¡')) {
                    // æŸ¥ç„¡ç´€éŒ„
                    //resultDiv.className = 'error';
                    //resultDiv.innerHTML = `GMAIL <strong>${gmail}</strong>ï¼š${score}`;
                    //alert(`~~+++æŸ¥è©¢çµæœï¼š${score}`);
document.getElementById("sayy").innerText="æº–å‚™é€²å…¥æ¸¬é©—â€¦â€¦"
   	   document.getElementById("start-btn").style.display = "block";
                } else {
                    // æˆåŠŸé¡¯ç¤ºåˆ†æ•¸
                    //resultDiv.className = 'success';
                    //resultDiv.innerHTML = `GMAIL: <strong>${data.gmail}</strong><br>åˆ†æ•¸: <strong style="font-size: 1.5em;">${score}</strong>`;
                    //alert(`====GMAIL ${data.gmail} çš„åˆ†æ•¸æ˜¯ï¼š${score}`);

document.getElementById("sayy").innerText ="å·²æœ‰è€ƒè©¦æˆç¸¾ï¼Œç„¡æ³•å†æ¸¬é©—ã€‚";
   	   document.getElementById("start-btn").style.display = "none";



                }
            } else {
                //resultDiv.className = 'error';
                //resultDiv.textContent = 'æŸ¥è©¢å¤±æ•—ï¼šä¼ºæœå™¨å›å‚³è³‡æ–™æ ¼å¼éŒ¯èª¤ã€‚';
                alert('æŸ¥è©¢å¤±æ•—ï¼šä¼ºæœå™¨å›å‚³è³‡æ–™æ ¼å¼éŒ¯èª¤ã€‚');
            }
        })
        .catch(error => {
            // ç™¼ç”ŸéŒ¯èª¤
            if (submitButton) submitButton.disabled = false;
            console.error('æŸ¥è©¢ç™¼ç”ŸéŒ¯èª¤:', error);
            //resultDiv.className = 'error';
            //const errorMessage = `æŸ¥è©¢ç™¼ç”ŸéŒ¯èª¤ï¼š ${error.message}ã€‚è«‹æª¢æŸ¥ GAS URL æˆ–ç¶²è·¯é€£ç·šã€‚`;
            //resultDiv.textContent = errorMessage;
            alert(errorMessage);
        });
    }

    // ------------------------------------
    // ç«‹å³åŸ·è¡ŒæŸ¥è©¢å‡½å¼
    // ------------------------------------
    autoQuery();

////~~~~~~~~~~~~

    // --- äº‹ä»¶ç›£è½ ---
    startBtn.addEventListener('click', startQuiz);
    prevBtn.addEventListener('click', prevQuestion);
    nextBtn.addEventListener('click', nextQuestion);
    submitBtn.addEventListener('click', submitQuiz);
    restartBtn.addEventListener('click', restartQuiz);
    
    downloadPdfBtn.addEventListener('click', downloadPDF);
    downloadCsvBtn.addEventListener('click', downloadCSV);

</script>
</body>
</html>