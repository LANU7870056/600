<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="UTF-8">
<title>é›»å­é»åè¡¨å–®</title>
<style>
    /* å¯é¸ï¼šè®“è¡¨å–®æ›´å¥½çœ‹ä¸€é» */
    body { font-family: Arial, sans-serif; margin: 0px; }
    
    /* ä¿®æ­£ï¼šè®“ form#myForm ç¨ç«‹å‡ºä¾†ï¼Œæ–¹ä¾¿æ§åˆ¶ */
    form#myForm { 
        width: 100%; /* è®“è¡¨å–®å¡«æ»¿ centered-box */
        padding: 10px; 
        box-sizing: border-box; 
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    label, input, select, button { display: block; margin-bottom: 10px; }
    input[type="text"], input[type="number"], select { 
        width: 70%; 
        padding: 8px; 
        box-sizing: border-box; 
    }
    button { 
        padding: 10px 15px; 
        background-color: #4CAF50; 
        color: white; 
        border: none; 
        cursor: pointer; 
    }

.centered-box {
    display: flex;
    justify-content: center; /* æ°´å¹³ç½®ä¸­ */
    align-items: center;      /* å‚ç›´ç½®ä¸­ */
    flex-direction: column; /* ç¢ºä¿å…§å®¹å‚ç›´æ’åˆ— */
    width: 70%;
    margin: 20px auto; /* ç½®ä¸­ä¸¦åŠ é»ä¸Šä¸‹é‚Šè· */
    background-color: #e0f0ff; /* æ·ºè—åº•è‰² */
    border-radius: 15px; /* åœ“è§’ */
    padding: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
    text-align: center;
}

.la {
    margin: 10px 0;
    font-size:1.5em;
    text-align: center;
}

.form {
    width: 100%; /* ç¢ºä¿ .form å¯¬åº¦è¶³å¤  */
}
</style>
</head>
<body>

<div class="centered-box">
    
    <div class="form">
        <h1>é›»å­é»å</h1>
        
        <form id="myForm">
            <table border="0" width="500">
                <tr>
                    <td colspan="2" align="center">
                        <input type="hidden" id="backurl" value="https://lanu7870056.github.io/600/order01.htm" name="backurl">
                        <input class="la" type="text" id="gmail" name="GMAIL" style="background-color: #d3d3d3;" readonly>
                    </td>
                </tr>
                <tr>
                    <td style="width: 80px;"><label class="la" for="classId">ç­ç´š:</label></td>
                    <td style="width: 420px;">
                        <select class="la" id="classId" name="ç­ç´š" required>
                            <option value="">-- è«‹é¸æ“‡ç­ç´š --</option>
                            <option value="101">101</option>
                            <option value="102">102</option>
                            <option value="103">103</option>
                            <option value="104">104</option>
                            <option value="105">105</option>
                            <option value="108">108</option>
                            <option value="109">109</option>
                            <option value="110">110</option>
                            <option value="111">111</option>
                            <option value="113">113</option>
                            <option value="114">114</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td style="width: 80px;"><label class="la" for="seatNum">åº§è™Ÿï¼š</label></td>
                    <td>
                        <input class="la" type="number" id="seatNum" name="åº§è™Ÿ" min="1" max="50" required>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" align="center">
                        <button class="la" type="submit">é€å‡ºè³‡æ–™</button>
                    </td>
                </tr>
            </table>
        </form>
    </div> <p id="responseMessage" style="margin-top: 20px; font-weight: bold;"></p>

</div> <script>
let A = localStorage.getItem("GM");Â  //å–å‡º
if (A) {
    document.getElementById('gmail').value = A;
}


Â  Â  // âš ï¸ é€™æ˜¯æ‚¨ Apps Script çš„ Web App URLï¼Œè«‹ç¢ºèªå®ƒæ˜¯å¦æ­£ç¢º
Â  Â  const APP_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbysGyVzYeLYlX_hxlff_KoCgXZma1ayMujEl8D4bq0jsPOmM8Gd6p9sofIdzt2my325/exec";Â Â 
Â  Â Â 
Â  Â  document.getElementById('myForm').addEventListener('submit', async function(event) {
Â  Â  Â  Â  // â­ï¸ é˜»æ­¢ç€è¦½å™¨åŸ·è¡Œå‚³çµ±æäº¤ (é—œéµæ­¥é©Ÿï¼Œè®“ç¶²å€æ¬„ä¸è®Š)
Â  Â  Â  Â  event.preventDefault();Â 

Â  Â  Â  Â  const form = event.target;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- ğŸ¯ å¿…å¡«æ¬„ä½æª¢æŸ¥é‚è¼¯ ğŸ¯ ---
Â  Â  Â  Â  const classId = document.getElementById('classId').value;
Â  Â  Â  Â  const seatNum = document.getElementById('seatNum').value;
Â  Â  Â  Â  const responseMessage = document.getElementById('responseMessage');
        
        responseMessage.textContent = ''; // æ¸…ç©ºèˆŠè¨Šæ¯

Â  Â  Â  Â  if (classId === "") {
Â  Â  Â  Â  Â  Â  // ç­ç´šæœªé¸æ“‡æ™‚ï¼Œå½ˆå‡ºè¦–çª—æé†’
Â  Â  Â  Â  Â  Â  alert("è«‹é¸æ“‡ç­ç´šï¼");Â 
Â  Â  Â  Â  Â  Â  responseMessage.textContent = 'âš ï¸ è«‹é¸æ“‡ç­ç´šå¾Œå†é€å‡ºè³‡æ–™ã€‚';
Â  Â  Â  Â  Â  Â  responseMessage.style.color = 'orange';
Â  Â  Â  Â  Â  Â  return; // åœæ­¢åŸ·è¡Œå¾ŒçºŒç¨‹å¼ç¢¼ï¼Œé˜»æ­¢é€å‡º
Â  Â  Â  Â  }

Â  Â  Â  Â  if (seatNum === "") {
Â  Â  Â  Â  Â  Â  // åº§è™Ÿæœªè¼¸å…¥æ™‚ï¼Œå½ˆå‡ºè¦–çª—æé†’
Â  Â  Â  Â  Â  Â  alert("è«‹è¼¸å…¥åº§è™Ÿï¼");Â 
Â  Â  Â  Â  Â  Â  responseMessage.textContent = 'âš ï¸ è«‹è¼¸å…¥åº§è™Ÿå¾Œå†é€å‡ºè³‡æ–™ã€‚';
Â  Â  Â  Â  Â  Â  responseMessage.style.color = 'orange';
Â  Â  Â  Â  Â  Â  return; // åœæ­¢åŸ·è¡Œå¾ŒçºŒç¨‹å¼ç¢¼ï¼Œé˜»æ­¢é€å‡º
Â  Â  Â  Â  }
Â  Â  Â  Â  // --- ğŸ¯ æª¢æŸ¥é‚è¼¯çµæŸ ğŸ¯ ---

Â  Â  Â  Â  const formData = new FormData(form);
Â  Â  Â  Â  const data = {};
Â  Â  Â  Â  formData.forEach((value, key) => { data[key] = value; });

Â  Â  Â  Â  responseMessage.textContent = 'è³‡æ–™è™•ç†ä¸­...';
Â  Â  Â  Â  responseMessage.style.color = 'blue';

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  const response = await fetch(APP_SCRIPT_URL, {
Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  // å°‡æ•¸æ“šè½‰æ›ç‚º Apps Script æœŸæœ›çš„æ ¼å¼
Â  Â  Â  Â  Â  Â  Â  Â  body: new URLSearchParams(data)Â Â 
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`ä¼ºæœå™¨ HTTP éŒ¯èª¤: ${response.status}`);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // â­ï¸ è§£æ Apps Script å›å‚³çš„ JSON ç‹€æ…‹
Â  Â  Â  Â  Â  Â  const result = await response.json();Â 

Â  Â  Â  Â  Â  Â  if (result.status === 'duplicate') {
Â  Â  Â  Â  Â  Â  Â  Â  // ğŸš¨ è³‡æ–™é‡è¤‡ï¼šåœ¨ç•¶å‰é é¢å½ˆçª—ä¸¦æ›´æ–°è¨Šæ¯
Â  Â  Â  Â  Â  Â  Â  Â  alert("å ±åˆ°é‡è¦†ï¼Œç³»çµ±è‡ªå‹•æ‰£1åˆ†");Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  responseMessage.textContent = 'âŒ ' + result.message;
Â  Â  Â  Â  Â  Â  Â  Â  responseMessage.style.color = 'red';
Â  Â  Â  Â  Â  Â  } else if (result.status === 'success') {
Â  Â  Â  Â  Â  Â  Â  Â  // âœ… è³‡æ–™æ–°å¢æˆåŠŸ
Â  Â  Â  Â  Â  Â  Â  Â  alert("è³‡æ–™é€å‡ºæˆåŠŸï¼");
Â  Â  Â  Â  Â  Â  Â  Â  responseMessage.textContent = 'âœ… ' + result.message;
Â  Â  Â  Â  Â  Â  Â  Â  responseMessage.style.color = 'green';
Â  Â  Â  Â  Â  Â  Â  Â  form.reset(); // æ¸…ç©ºè¡¨å–®æ¬„ä½
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // è™•ç† Apps Script å›å‚³çš„å…¶å®ƒéŒ¯èª¤ (å¦‚åº§è™Ÿç¯„åœéŒ¯èª¤)
Â  Â  Â  Â  Â  Â  Â  Â  alert("è³‡æ–™è™•ç†éŒ¯èª¤ï¼š" + result.message);
Â  Â  Â  Â  Â  Â  Â  Â  responseMessage.textContent = 'âš ï¸ ' + result.message;
Â  Â  Â  Â  Â  Â  Â  Â  responseMessage.style.color = 'orange';
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  alert("ç¶²è·¯é€£ç·šæˆ– Apps Script éŒ¯èª¤ï¼");
Â  Â  Â  Â  Â  Â  responseMessage.textContent = 'âŒ é€£ç·šå¤±æ•—: ' + error.message;
Â  Â  Â  Â  Â  Â  responseMessage.style.color = 'red';
Â  Â  Â  Â  }
Â  Â  });
</script>

</body>
</html>